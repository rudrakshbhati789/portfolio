<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Admin Panel - Radha Rani Parlour</title>
<link rel="stylesheet" href="admin.css">
</head>
<body>

<h1>Admin Panel</h1>

<!-- LOGIN -->
<div id="loginDiv">
  <h2>Login</h2>
  <input id="adminUser" placeholder="Username">
  <input id="adminPass" type="password" placeholder="Password">
  <button onclick="login()">Login</button>
  <p id="loginMsg" style="color:red;"></p>
</div>

<!-- DASHBOARD -->
<div id="dashboard" style="display:none;">
  <h2>Welcome Admin</h2>
  
  <section>
    <h3>Add / Update Slots</h3>
    <input id="service" placeholder="Service Name">
    <input id="slots" placeholder="Slots (comma separated)">
    <button onclick="uploadSlots()">Save Slots</button>
  </section>
  
  <section>
    <h3>All Bookings</h3>
    <table border="1" cellpadding="5" cellspacing="0">
      <thead>
        <tr><th>Name</th><th>Phone</th><th>Service</th><th>Date</th><th>Time</th><th>Message</th></tr>
      </thead>
      <tbody id="bookingsTable"></tbody>
    </table>
  </section>
  
  <button onclick="logout()">Logout</button>
</div>

<script>
const ADMIN_USER = "radharani13";
const ADMIN_PASS = "sweeta@789";

function login(){
  const user = document.getElementById("adminUser").value;
  const pass = document.getElementById("adminPass").value;
  if(user === ADMIN_USER && pass === ADMIN_PASS){
    document.getElementById("loginDiv").style.display="none";
    document.getElementById("dashboard").style.display="block";
    loadBookings();
  } else {
    document.getElementById("loginMsg").innerText="Incorrect username or password!";
  }
}

function logout(){
  document.getElementById("loginDiv").style.display="block";
  document.getElementById("dashboard").style.display="none";
  document.getElementById("adminUser").value="";
  document.getElementById("adminPass").value="";
  document.getElementById("loginMsg").innerText="";
}

async function uploadSlots(){
  const service = document.getElementById("service").value;
  const slots = document.getElementById("slots").value.split(",");
  await fetch("/api/slots", {
    method:"POST",
    headers:{"Content-Type":"application/json"},
    body: JSON.stringify({ service, slots })
  });
  alert("Slots saved!");
}

async function loadBookings(){
  const res = await fetch("/api/bookings");
  const data = await res.json();
  const table = document.getElementById("bookingsTable");
  table.innerHTML="";
  data.forEach(b => {
    const row = `<tr>
      <td>${b.name}</td>
      <td>${b.phone}</td>
      <td>${b.service}</td>
      <td>${b.date}</td>
      <td>${b.time}</td>
      <td>${b.message}</td>
    </tr>`;
    table.innerHTML += row;
  });
}
</script>
</body>
</html>
